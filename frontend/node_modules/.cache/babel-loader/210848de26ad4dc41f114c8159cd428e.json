{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/carinawollendorfer/selfix/frontend/src/components/CommentRowComponent.js\",\n    _s = $RefreshSig$();\n\nimport PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Typography, IconButton, TextField, Divider, Dialog, DialogContent, DialogContentText, DialogActions, ListItem, ListItemText, ListItemSecondaryAction } from '@material-ui/core';\nimport EditIcon from '@material-ui/icons/Edit';\nimport UserService from '../services/UserService';\nimport Grid from '@material-ui/core/Grid';\nimport CommentService from '../services/CommentService';\nimport Button from '@material-ui/core/Button';\nimport moment from 'moment';\nimport ChatBubbleOutlineIcon from '@material-ui/icons/ChatBubbleOutline';\nimport { Clear } from '@material-ui/icons';\nimport FileuploadService from '../services/FileuploadService';\nimport FileuploadComponent from './FileuploadComponent';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { Alert } from '@material-ui/lab';\nimport List from '@material-ui/core/List';\nimport Zoom from 'react-medium-image-zoom';\nimport 'react-medium-image-zoom/dist/styles.css';\nconst useStyles = makeStyles(theme => ({\n  userName: {\n    fontWeight: 'bold',\n    paddingRight: '10px'\n  },\n  date: {\n    color: '#9F9D9D',\n    fontWeight: 'normal'\n  },\n  textField: {\n    width: '100%'\n  },\n  button: {\n    height: '25px',\n    marginTop: '5px',\n    marginRight: '10px',\n    marginBottom: '10px',\n    fontSize: '12px',\n    textTransform: 'none',\n    background: theme.palette.secondary.light\n  },\n  chatIcon: {\n    marginTop: '5px'\n  },\n  divider: {\n    marginTop: '10px',\n    marginBottom: '30px'\n  },\n  image: {\n    maxWidth: '70%',\n    height: 'auto',\n    border: 'solid 0.5px',\n    borderColor: 'lightgray',\n    borderRadius: 4\n  },\n  imageEdit: {\n    maxWidth: '70%',\n    height: 'auto',\n    border: 'solid 0.5px',\n    borderColor: 'lightgray',\n    borderRadius: 4\n  },\n  imageDiv: {\n    maxWidth: '70%',\n    height: 'auto',\n    display: 'flex'\n  },\n  imgDelete: {\n    top: 0,\n    color: 'red',\n    marginLeft: -22\n  },\n  commentButtons: {\n    alignContent: 'end'\n  },\n  whiteSpaceText: {\n    whiteSpace: 'pre-line'\n  }\n}));\n/**\n * Component for comment section\n * @param {props} props\n */\n\nfunction CommentRowComponent(props) {\n  _s();\n\n  const classes = useStyles();\n  const [userName, setUserName] = React.useState('user');\n  const [isEditMode, setIsEditMode] = React.useState(false);\n  const firstUpdate = React.useRef(true);\n  const date = moment(props.comment.creationDate).format('DD. MMM YYYY');\n  const [textComment, setTextComment] = React.useState(props.comment.commentText);\n  const [deleteDialogOpen, setDeleteDialogOpen] = React.useState(false);\n  const [deleteCommentDialogOpen, setDeleteCommentDialogOpen] = React.useState(false);\n  const [fileName, setFileName] = useState('');\n  const [file, setFile] = useState(undefined);\n  const [errorText, setErrorText] = useState('');\n  React.useLayoutEffect(() => {\n    if (firstUpdate.current) {\n      firstUpdate.current = false;\n      setUserName('');\n    }\n  });\n  React.useEffect(async () => {\n    try {\n      const userData = await UserService.getUser(props.comment.userId);\n      setUserName(userData.username);\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n\n  const handleDeleteDialogClickOpen = () => {\n    setDeleteDialogOpen(true);\n  };\n\n  const handleDeleteDialogClose = () => {\n    setDeleteDialogOpen(false);\n  };\n\n  const handleDeleteCommentDialogClickOpen = () => {\n    setDeleteCommentDialogOpen(true);\n  };\n\n  const handleDeleteCommentDialogClose = () => {\n    setDeleteCommentDialogOpen(false);\n  };\n\n  const handleDeleteFile = () => {\n    (async () => {\n      setDeleteDialogOpen(false);\n      const imageUrl = props.comment.imageUrl;\n      props.comment.imageUrl = '';\n\n      try {\n        const result = await FileuploadService.deleteFile(imageUrl);\n        console.log(result);\n      } catch (e) {\n        console.log(e);\n      }\n\n      await CommentService.updateComment(props.comment);\n    })();\n  };\n\n  function deleteComment() {\n    (async () => {\n      await CommentService.deleteComment(props.comment.id);\n      const pos = props.step.comments.map(c => c.id).indexOf(props.comment.id);\n      const updatedStep = props.step;\n      updatedStep.comments.splice(pos, 1);\n      props.changeNrOfComments(updatedStep.comments.length); //props.setReload(!props.reload);\n\n      setDeleteCommentDialogOpen(false);\n    })();\n  }\n\n  function changeToEditMode() {\n    setIsEditMode(true);\n  }\n\n  function closeEditMode() {\n    setIsEditMode(false);\n  }\n\n  function updateComment() {\n    (async () => {\n      let fileuploadResponse;\n      const comment = props.comment;\n\n      if (file) {\n        try {\n          fileuploadResponse = await FileuploadService.uploadCommentImage(file, props.comment.userId);\n          setFile(undefined);\n          setFileName('');\n          setErrorText('');\n\n          if (fileuploadResponse != null && fileuploadResponse.files && fileuploadResponse.files.length > 0) {\n            comment.imageUrl = fileuploadResponse.files[0];\n          }\n        } catch (e) {\n          setErrorText('Error while uploading file');\n        }\n      }\n\n      comment.commentText = textComment;\n      CommentService.updateComment(comment);\n      setIsEditMode(false);\n    })();\n  }\n\n  function handleTextFieldChange(e) {\n    setTextComment(e.target.value);\n  }\n\n  function uploadFile(fileToUpload, fileToUploadName, error) {\n    setFile(fileToUpload);\n    setFileName(fileToUploadName);\n    setErrorText(error);\n  }\n\n  function removeFile() {\n    setFile(undefined);\n    setFileName('');\n  }\n\n  if (!isEditMode) {\n    return /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 5,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 0.5,\n        children: /*#__PURE__*/_jsxDEV(ChatBubbleOutlineIcon, {\n          color: \"secondary\",\n          fontSize: \"small\",\n          className: classes.chatIcon\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 10,\n        direction: \"column\",\n        spacing: 2,\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"subtitle2\",\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body2\",\n            className: classes.userName,\n            children: [userName, \"  \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: classes.date,\n              children: [\" \", date]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 27\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this), props.comment.imageUrl && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.imageDiv,\n          children: /*#__PURE__*/_jsxDEV(Zoom, {\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: props.comment.imageUrl,\n              className: classes.image,\n              alt: props.comment.imageUrl\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 13\n        }, this), props.comment.imageUrl && /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 39\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          className: classes.whiteSpaceText,\n          children: props.comment.commentText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Divider, {\n          variant: \"middle\",\n          className: classes.divider\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 1.5,\n        children: props.comment.userId === props.curUser ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(IconButton, {\n            color: \"secondary\",\n            onClick: changeToEditMode,\n            children: /*#__PURE__*/_jsxDEV(EditIcon, {\n              fontSize: \"small\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n            open: deleteCommentDialogOpen,\n            onClose: handleDeleteCommentDialogClose,\n            children: [/*#__PURE__*/_jsxDEV(DialogContent, {\n              children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n                children: 'Are you sure you want to delete the comment?'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                onClick: handleDeleteCommentDialogClose,\n                color: \"primary\",\n                children: \"Cancel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                onClick: deleteComment,\n                color: \"primary\",\n                autoFocus: true,\n                children: \"Delete\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n            color: \"secondary\",\n            onClick: handleDeleteCommentDialogClickOpen,\n            children: /*#__PURE__*/_jsxDEV(DeleteIcon, {\n              fontSize: \"small\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 24\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 7\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 5,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 0.5,\n        children: /*#__PURE__*/_jsxDEV(ChatBubbleOutlineIcon, {\n          color: \"secondary\",\n          fontSize: \"small\",\n          className: classes.chatIcon\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 10,\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          className: classes.userName,\n          children: [userName, \"  \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: classes.date,\n            children: [\" \", date]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 11\n        }, this), props.comment.imageUrl && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.imageDiv,\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: props.comment.imageUrl,\n            className: classes.imageEdit,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n            open: deleteDialogOpen,\n            onClose: handleDeleteDialogClose,\n            children: [/*#__PURE__*/_jsxDEV(DialogContent, {\n              children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n                children: 'Are you sure you want to delete the file?'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 278,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                onClick: handleDeleteDialogClose,\n                color: \"primary\",\n                children: \"Cancel\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                onClick: handleDeleteFile,\n                color: \"primary\",\n                autoFocus: true,\n                children: \"Delete\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Clear, {\n            className: classes.imgDelete,\n            onClick: handleDeleteDialogClickOpen\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, this), props.comment.imageUrl && /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 39\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          multiline: true,\n          rows: 3,\n          variant: \"outlined\",\n          className: classes.textField,\n          value: textComment,\n          onChange: handleTextFieldChange,\n          onKeyPress: event => {\n            if (event.key === 'Enter' && !event.shiftKey) {\n              event.preventDefault();\n              updateComment();\n            }\n          },\n          InputProps: !props.comment.imageUrl && {\n            endAdornment: /*#__PURE__*/_jsxDEV(FileuploadComponent, {\n              files: 1,\n              sizeLimit: 10 * 1024 * 1024,\n              allowedMimeTypes: ['image/png', 'image/jpeg'],\n              uploadFunction: uploadFile\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 31\n            }, this)\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(List, {\n          children: [file !== undefined && /*#__PURE__*/_jsxDEV(ListItem, {\n            children: [/*#__PURE__*/_jsxDEV(ListItemText, {\n              primary: fileName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListItemSecondaryAction, {\n              children: /*#__PURE__*/_jsxDEV(IconButton, {\n                edge: \"end\",\n                \"aria-label\": \"comments\",\n                onClick: removeFile,\n                children: /*#__PURE__*/_jsxDEV(DeleteIcon, {\n                  className: classes.deleteIcon\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 319,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 15\n          }, this), errorText !== '' && /*#__PURE__*/_jsxDEV(Alert, {\n            severity: \"error\",\n            children: errorText\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          onClick: updateComment,\n          className: classes.button,\n          disabled: textComment.length === 0,\n          children: \"Update\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          onClick: closeEditMode,\n          className: classes.button,\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 1.5\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }, this);\n  }\n}\n\n_s(CommentRowComponent, \"zJ/1V5e57+FMy9zq/xvAcOPA8rk=\", false, function () {\n  return [useStyles];\n});\n\n_c = CommentRowComponent;\nCommentRowComponent.propTypes = {\n  comment: PropTypes.object.isRequired,\n  curUser: PropTypes.string.isRequired,\n  step: PropTypes.object.isRequired,\n  setReload: PropTypes.func,\n  reload: PropTypes.bool,\n  type: PropTypes.string,\n  changeNrOfComments: PropTypes.func,\n  comments: PropTypes.array,\n  setComments: PropTypes.func\n};\nexport default CommentRowComponent;\n\nvar _c;\n\n$RefreshReg$(_c, \"CommentRowComponent\");","map":{"version":3,"sources":["/Users/carinawollendorfer/selfix/frontend/src/components/CommentRowComponent.js"],"names":["PropTypes","React","useState","makeStyles","Typography","IconButton","TextField","Divider","Dialog","DialogContent","DialogContentText","DialogActions","ListItem","ListItemText","ListItemSecondaryAction","EditIcon","UserService","Grid","CommentService","Button","moment","ChatBubbleOutlineIcon","Clear","FileuploadService","FileuploadComponent","DeleteIcon","Alert","List","Zoom","useStyles","theme","userName","fontWeight","paddingRight","date","color","textField","width","button","height","marginTop","marginRight","marginBottom","fontSize","textTransform","background","palette","secondary","light","chatIcon","divider","image","maxWidth","border","borderColor","borderRadius","imageEdit","imageDiv","display","imgDelete","top","marginLeft","commentButtons","alignContent","whiteSpaceText","whiteSpace","CommentRowComponent","props","classes","setUserName","isEditMode","setIsEditMode","firstUpdate","useRef","comment","creationDate","format","textComment","setTextComment","commentText","deleteDialogOpen","setDeleteDialogOpen","deleteCommentDialogOpen","setDeleteCommentDialogOpen","fileName","setFileName","file","setFile","undefined","errorText","setErrorText","useLayoutEffect","current","useEffect","userData","getUser","userId","username","e","console","log","handleDeleteDialogClickOpen","handleDeleteDialogClose","handleDeleteCommentDialogClickOpen","handleDeleteCommentDialogClose","handleDeleteFile","imageUrl","result","deleteFile","updateComment","deleteComment","id","pos","step","comments","map","c","indexOf","updatedStep","splice","changeNrOfComments","length","changeToEditMode","closeEditMode","fileuploadResponse","uploadCommentImage","files","handleTextFieldChange","target","value","uploadFile","fileToUpload","fileToUploadName","error","removeFile","curUser","event","key","shiftKey","preventDefault","endAdornment","deleteIcon","propTypes","object","isRequired","string","setReload","func","reload","bool","type","array","setComments"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types';\nimport React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { Typography, IconButton, TextField, Divider, Dialog, DialogContent, DialogContentText, DialogActions, ListItem, ListItemText, ListItemSecondaryAction } from '@material-ui/core';\nimport EditIcon from '@material-ui/icons/Edit';\nimport UserService from '../services/UserService';\nimport Grid from '@material-ui/core/Grid';\nimport CommentService from '../services/CommentService';\nimport Button from '@material-ui/core/Button';\nimport moment from 'moment';\nimport ChatBubbleOutlineIcon from '@material-ui/icons/ChatBubbleOutline';\nimport { Clear } from '@material-ui/icons';\nimport FileuploadService from '../services/FileuploadService';\nimport FileuploadComponent from './FileuploadComponent';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { Alert } from '@material-ui/lab';\nimport List from '@material-ui/core/List';\nimport Zoom from 'react-medium-image-zoom';\nimport 'react-medium-image-zoom/dist/styles.css';\n\nconst useStyles = makeStyles((theme) => ({\n  userName: {\n    fontWeight: 'bold',\n    paddingRight: '10px',\n  },\n  date: {\n    color: '#9F9D9D',\n    fontWeight: 'normal'\n  },\n  textField: {\n    width: '100%',\n  },\n  button: {\n    height: '25px',\n    marginTop: '5px',\n    marginRight: '10px',\n    marginBottom: '10px',\n    fontSize: '12px',\n    textTransform: 'none',\n    background: theme.palette.secondary.light\n  },\n  chatIcon: {\n    marginTop: '5px',\n  },\n  divider: {\n    marginTop: '10px',\n    marginBottom: '30px',\n  },\n  image: {\n    maxWidth: '70%',\n    height: 'auto',\n    border: 'solid 0.5px',\n    borderColor: 'lightgray',\n    borderRadius: 4\n  },\n  imageEdit: {\n    maxWidth: '70%',\n    height: 'auto',\n    border: 'solid 0.5px',\n    borderColor: 'lightgray',\n    borderRadius: 4\n  },\n  imageDiv: {\n    maxWidth: '70%',\n    height: 'auto',\n    display: 'flex',\n  },\n  imgDelete: {\n    top: 0,\n    color: 'red',\n    marginLeft: -22,\n  },\n  commentButtons: {\n    alignContent: 'end'\n  },\n  whiteSpaceText: {\n    whiteSpace: 'pre-line',\n  }\n}));\n\n/**\n * Component for comment section\n * @param {props} props\n */\nfunction CommentRowComponent(props) {\n  const classes = useStyles();\n  const [userName, setUserName] = React.useState('user');\n  const [isEditMode, setIsEditMode] = React.useState(false);\n  const firstUpdate = React.useRef(true);\n  const date = moment(props.comment.creationDate).format('DD. MMM YYYY');\n  const [textComment, setTextComment] = React.useState(props.comment.commentText);\n  const [deleteDialogOpen, setDeleteDialogOpen] = React.useState(false);\n  const [deleteCommentDialogOpen, setDeleteCommentDialogOpen] = React.useState(false);\n  const [fileName, setFileName] = useState('');\n  const [file, setFile] = useState(undefined);\n  const [errorText, setErrorText] = useState('');\n\n  React.useLayoutEffect(() => {\n    if (firstUpdate.current) {\n      firstUpdate.current = false;\n      setUserName('');\n    }\n  });\n\n  React.useEffect(async () => {\n    try{\n      const userData = await UserService.getUser(props.comment.userId);\n      setUserName(userData.username);\n    } catch(e) {\n      console.log(e);\n    }\n  }, []);\n\n  const handleDeleteDialogClickOpen = () => {\n    setDeleteDialogOpen(true);\n  };\n\n  const handleDeleteDialogClose = () => {\n    setDeleteDialogOpen(false);\n  };\n\n  const handleDeleteCommentDialogClickOpen = () => {\n    setDeleteCommentDialogOpen(true);\n  };\n\n  const handleDeleteCommentDialogClose = () => {\n    setDeleteCommentDialogOpen(false);\n  };\n\n  const handleDeleteFile = () => {\n    (async () => {\n      setDeleteDialogOpen(false);\n      const imageUrl = props.comment.imageUrl;\n      props.comment.imageUrl = '';\n      try{\n        const result = await FileuploadService.deleteFile(imageUrl);\n        console.log(result);\n      } catch(e) {\n        console.log(e);\n      }\n      await CommentService.updateComment(props.comment);\n    })();\n  };\n\n  function deleteComment() {\n    (async () => {\n      await CommentService.deleteComment(props.comment.id);\n      const pos = props.step.comments.map(c => c.id).indexOf(props.comment.id);\n      const updatedStep = props.step;\n      updatedStep.comments.splice(pos, 1);\n      props.changeNrOfComments(updatedStep.comments.length);\n      //props.setReload(!props.reload);\n      setDeleteCommentDialogOpen(false);\n    })(); \n  }\n\n  function changeToEditMode() {\n    setIsEditMode(true);\n  }\n\n  function closeEditMode() {\n    setIsEditMode(false);\n  }\n\n  function updateComment() {\n    (async () => {\n      let fileuploadResponse;\n      const comment = props.comment;\n      if (file) {\n        try{\n          fileuploadResponse = await FileuploadService.uploadCommentImage(file, props.comment.userId);\n          setFile(undefined);\n          setFileName('');\n          setErrorText('');\n          if (fileuploadResponse != null && fileuploadResponse.files && fileuploadResponse.files.length > 0) {\n            comment.imageUrl = fileuploadResponse.files[0];\n          }\n        } catch(e){\n          setErrorText('Error while uploading file');\n        }\n        \n      }\n\n      comment.commentText = textComment;\n      CommentService.updateComment(comment);\n      setIsEditMode(false);\n    })();\n  }\n\n  function handleTextFieldChange(e) {\n    setTextComment(e.target.value);\n  }\n\n  function uploadFile(fileToUpload, fileToUploadName, error) {\n    setFile(fileToUpload);\n    setFileName(fileToUploadName);\n    setErrorText(error);\n  }\n\n  function removeFile() {\n    setFile(undefined);\n    setFileName('');\n  }\n\n  if (!isEditMode) {\n    return (\n      <Grid container spacing={5}>\n        <Grid item xs={0.5}>\n          <ChatBubbleOutlineIcon color=\"secondary\" fontSize=\"small\" className={classes.chatIcon} />\n        </Grid>\n        <Grid item xs={10} direction=\"column\" spacing={2}>\n          <Typography variant=\"subtitle2\">\n            <Typography variant=\"body2\" className={classes.userName}>\n              {userName}  <span className={classes.date}> {date}</span>\n            </Typography>\n          </Typography>\n          <br />\n          {props.comment.imageUrl && (\n            <div className={classes.imageDiv}>\n              <Zoom>\n                <img src={props.comment.imageUrl} className={classes.image} alt={props.comment.imageUrl} />\n              </Zoom>\n            </div>\n          )}\n          {props.comment.imageUrl && (<br />)}\n          <Typography variant=\"body2\" className={classes.whiteSpaceText}>\n            {props.comment.commentText}\n          </Typography>\n\n          <Divider variant=\"middle\" className={classes.divider} />\n        </Grid>\n\n        <Grid item xs={1.5}>\n          {props.comment.userId === props.curUser ? (\n            <div>\n              <IconButton color=\"secondary\" onClick={changeToEditMode}>\n                <EditIcon fontSize=\"small\" />\n              </IconButton>\n              <Dialog open={deleteCommentDialogOpen} onClose={handleDeleteCommentDialogClose}>\n                <DialogContent>\n                  <DialogContentText>{'Are you sure you want to delete the comment?'}</DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                  <Button onClick={handleDeleteCommentDialogClose} color=\"primary\">\n                    Cancel\n                  </Button>\n                  <Button onClick={deleteComment} color=\"primary\" autoFocus>\n                    Delete\n                  </Button>\n                </DialogActions>\n              </Dialog>\n              <IconButton color=\"secondary\" onClick={handleDeleteCommentDialogClickOpen} >\n                <DeleteIcon fontSize=\"small\" />\n              </IconButton>\n            </div>) : (<div />)\n          }\n        </Grid>\n\n      </Grid>\n    );\n  } else {\n    return (\n      <Grid container spacing={5}>\n        <Grid item xs={0.5} >\n          <ChatBubbleOutlineIcon color=\"secondary\" fontSize=\"small\" className={classes.chatIcon} />\n        </Grid>\n        <Grid item xs={10}>\n          <Typography variant=\"body2\" className={classes.userName}>\n            {userName}  <span className={classes.date}> {date}</span>\n          </Typography>\n          <br />\n          {props.comment.imageUrl && (\n            <div className={classes.imageDiv}>\n              <img src={props.comment.imageUrl} className={classes.imageEdit} alt=\"\" />\n              <Dialog open={deleteDialogOpen} onClose={handleDeleteDialogClose}>\n                <DialogContent>\n                  <DialogContentText>{'Are you sure you want to delete the file?'}</DialogContentText>\n                </DialogContent>\n                <DialogActions>\n                  <Button onClick={handleDeleteDialogClose} color=\"primary\">\n                    Cancel\n                  </Button>\n                  <Button onClick={handleDeleteFile} color=\"primary\" autoFocus>\n                    Delete\n                  </Button>\n                </DialogActions>\n              </Dialog>\n              <Clear className={classes.imgDelete} onClick={handleDeleteDialogClickOpen} />\n            </div>\n          )}\n          {props.comment.imageUrl && (<br />)}\n          <TextField\n            multiline\n            rows={3}\n            variant=\"outlined\"\n            className={classes.textField}\n            value={textComment}\n            onChange={handleTextFieldChange}\n            onKeyPress={(event) => {\n              if(event.key === 'Enter' && !event.shiftKey) {\n                event.preventDefault();\n                updateComment();\n              }\n            }}\n            InputProps={\n              !props.comment.imageUrl && {\n                endAdornment: <FileuploadComponent files={1} sizeLimit={10 * 1024 * 1024} allowedMimeTypes={['image/png', 'image/jpeg']} uploadFunction={uploadFile} />,\n              }\n            }\n          />\n\n          <List>\n            {file !== undefined && (\n              <ListItem>\n                <ListItemText primary={fileName} />\n                <ListItemSecondaryAction>\n                  <IconButton edge=\"end\" aria-label=\"comments\" onClick={removeFile}>\n                    <DeleteIcon className={classes.deleteIcon} />\n                  </IconButton>\n                </ListItemSecondaryAction>\n              </ListItem>\n            )}\n            {errorText !== '' && <Alert severity=\"error\">{errorText}</Alert>}\n          </List>\n          <Button \n            variant=\"contained\"\n            onClick={updateComment}\n            className={classes.button}\n            disabled={textComment.length === 0}\n          >\n            Update\n          </Button>\n          <Button variant=\"contained\" onClick={closeEditMode} className={classes.button}>\n            Cancel\n          </Button>\n        </Grid>\n        <Grid item xs={1.5} />\n      </Grid>\n    );\n  }\n}\n\nCommentRowComponent.propTypes = {\n  comment: PropTypes.object.isRequired,\n  curUser: PropTypes.string.isRequired,\n  step: PropTypes.object.isRequired,\n  setReload: PropTypes.func,\n  reload: PropTypes.bool,\n  type: PropTypes.string,\n  changeNrOfComments: PropTypes.func,\n  comments: PropTypes.array,\n  setComments: PropTypes.func,\n};\n\nexport default CommentRowComponent;\n"]},"metadata":{},"sourceType":"module"}