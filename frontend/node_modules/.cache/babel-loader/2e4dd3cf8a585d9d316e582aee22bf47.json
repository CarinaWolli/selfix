{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/carinawollendorfer/selfix/frontend/src/views/TutorialCreation.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport TutorialService from '../services/TutorialService';\nimport BikeComponentService from '../services/BikeComponentService';\nimport ToolCategoryService from '../services/ToolCategoryService';\nimport TutorialCreationStepOne from '../components/cms/TutorialCreationStepOne';\nimport TutorialCreationStepTwo from '../components/cms/TutorialCreationStepTwo';\nimport TutorialCreationStepThree from '../components/cms/TutorialCreationStepThree';\nimport { Grid, Card, CardContent, Typography, Stepper, Step, StepLabel } from '@material-ui/core';\nimport FileuploadService from '../services/FileuploadService';\nimport { Alert } from '@material-ui/lab';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport { makeStyles } from '@material-ui/core/styles';\nconst useStyles = makeStyles(() => ({\n  main: {\n    marginLeft: '280px',\n    marginRight: '50px',\n    height: '100%'\n  }\n}));\n\nfunction TutorialCreation(props) {\n  _s();\n\n  const classes = useStyles();\n  const stepLabels = ['Basic Tutorial Information', 'Tutorial Steps', 'Related Products'];\n  const [editMode, setEditMode] = React.useState();\n  const [tutorialFetched, setTutorialFetched] = React.useState(false);\n  const [componentsFetched, setComponentsFetched] = React.useState(false);\n  const [toolsFetched, setToolsFetched] = React.useState(false);\n  const [errorText, setErrorText] = React.useState();\n  const [activeStep, setActiveStep] = React.useState(0);\n  const [steps, setSteps] = React.useState([]);\n  const [bikeComponents, setBikeComponents] = React.useState([]);\n  const [toolCategories, setToolCategories] = React.useState([]);\n  const [tutorialFile, setTutorialFile] = React.useState();\n  const [progress, setProgress] = React.useState(0);\n  const [tutorial, setTutorial] = React.useState({\n    name: '',\n    description: '',\n    imageUrl: '',\n    difficulty: 'Medium',\n    timeRequired: 60\n  });\n  React.useEffect(async () => {\n    if (props.match.params.tutorial) {\n      setEditMode(true);\n\n      try {\n        const tutorial = await TutorialService.getTutorialWithBikeComponents(props.match.params.tutorial);\n        setTutorial(tutorial);\n        const tutorialSteps = tutorial.steps.map(obj => {\n          const step = {};\n          step.title = obj.title;\n          step.description = obj.description;\n          step.mediaUrl = obj.mediaUrl;\n          step.isPicStep = obj.type === 'text' ? true : false;\n          return step;\n        });\n        setSteps(tutorialSteps);\n        setTutorialFetched(true);\n      } catch (e) {\n        console.log(e);\n      }\n    } else {\n      setEditMode(false);\n    }\n  }, [props.match.params.tutorial]);\n  React.useEffect(() => {\n    if (tutorialFetched && componentsFetched && toolsFetched) {\n      handleSelection(bikeComponents, setBikeComponents, tutorial.bikeComponents.map(obj => obj._id), true);\n      handleSelection(toolCategories, setToolCategories, tutorial.toolCategories.map(obj => obj._id), true);\n    }\n  }, [tutorialFetched, componentsFetched, toolsFetched]);\n  React.useEffect(async () => {\n    try {\n      if (props.match.params.tutorial) {\n        const data = await BikeComponentService.getAvailableBikeComponents(props.match.params.tutorial);\n        setBikeComponents(data.map(obj => ({ ...obj,\n          selected: false\n        })));\n        setComponentsFetched(true);\n      } else {\n        const data = await BikeComponentService.getUnmappedBikeComponents();\n        setBikeComponents(data.map(obj => ({ ...obj,\n          selected: false\n        })));\n      }\n    } catch (e) {\n      setErrorText(e);\n    }\n  }, [props.match.params.tutorial]);\n  React.useEffect(async () => {\n    try {\n      let data = await ToolCategoryService.getToolCategories();\n      setToolCategories(data.map(obj => ({ ...obj,\n        selected: false\n      })));\n      setToolsFetched(true);\n    } catch (e) {\n      setErrorText(e);\n    }\n  }, [props.match.params.tutorial]);\n\n  const addStep = step => {\n    let updatedSteps = [...steps];\n    updatedSteps.push(step);\n    setSteps(updatedSteps);\n  };\n\n  const updateStep = (step, id) => {\n    let updatedSteps = [...steps];\n    updatedSteps[id] = step;\n    setSteps(updatedSteps);\n  };\n\n  const deleteStep = id => {\n    let updatedSteps = [...steps];\n    updatedSteps.splice(id, 1);\n    setSteps(updatedSteps);\n  };\n\n  const handleSliderChange = (propertyName, newValue) => {\n    setTutorial({ ...tutorial,\n      [propertyName]: newValue\n    });\n  };\n\n  const handleTutorialChange = event => {\n    setTutorial({ ...tutorial,\n      [event.target.name]: event.target.value\n    });\n  };\n  /**\n   * Sets the selected property to boolVal for the object of the\n   * state object with id in selectedIds.\n   * @param {*} state\n   * @param {*} setFunc\n   * @param {*} selectedIds\n   * @param {*} boolVal\n   */\n\n\n  const handleSelection = (state, setFunc, selectedIds, boolVal) => {\n    const selectedItems = state.filter(obj => selectedIds.includes(obj._id)).map(obj => ({ ...obj,\n      selected: boolVal\n    }));\n    let rest = state.filter(obj => !selectedIds.includes(obj._id));\n\n    if (boolVal === true) {\n      rest = state.filter(obj => !selectedIds.includes(obj._id)).map(obj => ({ ...obj,\n        selected: !boolVal\n      }));\n    }\n\n    setFunc([...rest, ...selectedItems]);\n  };\n\n  const handleBCSelection = rows => {\n    handleSelection(bikeComponents, setBikeComponents, rows.map(obj => obj._id), true);\n  };\n\n  const handleDeselectBC = id => {\n    handleSelection(bikeComponents, setBikeComponents, [id], false);\n  };\n\n  const handleTCSelection = rows => {\n    handleSelection(toolCategories, setToolCategories, rows.map(obj => obj._id), true);\n  };\n\n  const handleDeselectTC = id => {\n    handleSelection(toolCategories, setToolCategories, [id], false);\n  };\n\n  async function asyncForEach(array, callback) {\n    for (let index = 0; index < array.length; index++) {\n      await callback(array[index], index, array);\n    }\n  }\n\n  const postTutorial = async () => {\n    try {\n      setProgress(0);\n      let requestBody = {};\n      requestBody.tutorial = tutorial;\n      let fileuploadResponse = {};\n\n      if (tutorialFile) {\n        try {\n          fileuploadResponse = await FileuploadService.uploadCMS(tutorialFile, 'tutorial');\n\n          if (fileuploadResponse.files && fileuploadResponse.files.length > 0) {\n            requestBody.tutorial.imageUrl = fileuploadResponse.files[0];\n          } else {\n            setErrorText('Tutorial:' + fileuploadResponse.message);\n            setProgress(0);\n            return;\n          }\n        } catch (e) {\n          setErrorText('Tutorial: Error while file upload. Please go back to step 1.');\n          setProgress(0);\n          return;\n        }\n      }\n\n      setProgress(5);\n      requestBody.tutorial.toolCategories = [];\n      requestBody.tutorial.toolCategories = toolCategories.filter(obj => obj.selected).map(obj => obj._id);\n      requestBody.bikeComponentIds = bikeComponents.filter(obj => obj.selected).map(obj => obj._id);\n      requestBody.textSteps = []; // List of text step objects\n\n      requestBody.videoSteps = []; // List of video step objects\n\n      await asyncForEach(steps, async step => {\n        if (step.file) {\n          try {\n            fileuploadResponse = await FileuploadService.uploadCMS(step.file, 'tutorialstep');\n\n            if (fileuploadResponse.files && fileuploadResponse.files.length > 0) {\n              step.mediaUrl = fileuploadResponse.files[0];\n            } else {\n              setErrorText('Step ' + step.title + ':' + fileuploadResponse.message);\n              setProgress(0);\n              return;\n            }\n          } catch (e) {\n            setErrorText('Step ' + step.title + ': Error while uploading file. Please go back to step 2.');\n            setProgress(0);\n            return;\n          }\n        }\n\n        setProgress(progress + 100 / (steps.length + 1));\n        delete step.file;\n      });\n      steps.map((step, index) => {\n        step['position'] = index;\n        const isPicStep = step.isPicStep;\n        delete step.isPicStep;\n\n        if (isPicStep) {\n          requestBody.textSteps.push(step);\n        } else {\n          requestBody.videoSteps.push(step);\n        }\n      });\n\n      if (editMode) {\n        await TutorialService.updateTutorial(requestBody);\n      } else {\n        await TutorialService.createTutorial(requestBody);\n      }\n\n      setProgress(100);\n      props.history.push('/admin/tutorials');\n    } catch (error) {\n      console.error(error);\n      setProgress(0);\n    }\n  };\n\n  const handleNext = () => {\n    setActiveStep(prevActiveStep => prevActiveStep + 1);\n  };\n\n  const handleBack = () => {\n    setActiveStep(prevActiveStep => prevActiveStep - 1);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.main,\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      children: [/*#__PURE__*/_jsxDEV(CardContent, {\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          spacing: 5,\n          justify: \"center\",\n          alignItems: \"center\",\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 10,\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h4\",\n              noWrap: true,\n              children: \"Create New Tutorial\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 15\n            }, this), errorText && /*#__PURE__*/_jsxDEV(Alert, {\n              severity: \"error\",\n              onClose: () => setErrorText(undefined),\n              children: errorText\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            children: /*#__PURE__*/_jsxDEV(Stepper, {\n              activeStep: activeStep,\n              alternativeLabel: true,\n              children: stepLabels.map((label, index) => {\n                return /*#__PURE__*/_jsxDEV(Step, {\n                  children: /*#__PURE__*/_jsxDEV(StepLabel, {\n                    children: label\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 282,\n                    columnNumber: 23\n                  }, this)\n                }, index, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 21\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 10,\n            children: (() => {\n              switch (activeStep) {\n                case 0:\n                  return /*#__PURE__*/_jsxDEV(TutorialCreationStepOne, {\n                    setErrorText: setErrorText,\n                    setTutorialFile: setTutorialFile,\n                    tutorialFile: tutorialFile,\n                    handleTutorialChange: handleTutorialChange,\n                    handleSliderChange: handleSliderChange,\n                    tutorial: tutorial,\n                    handleSubmit: handleNext\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 294,\n                    columnNumber: 23\n                  }, this);\n\n                case 1:\n                  return /*#__PURE__*/_jsxDEV(TutorialCreationStepTwo, {\n                    editMode: editMode,\n                    setErrorText: setErrorText,\n                    addStep: addStep,\n                    updateStep: updateStep,\n                    deleteStep: deleteStep,\n                    setSteps: setSteps,\n                    steps: steps,\n                    handleBack: handleBack,\n                    handleSubmit: handleNext\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 306,\n                    columnNumber: 23\n                  }, this);\n\n                case 2:\n                  return /*#__PURE__*/_jsxDEV(TutorialCreationStepThree, {\n                    handleTCSelection: handleTCSelection,\n                    handleDeselectBC: handleDeselectBC,\n                    bikeComponents: bikeComponents,\n                    handleBCSelection: handleBCSelection,\n                    handleDeselectTC: handleDeselectTC,\n                    toolCategories: toolCategories,\n                    tutorialFile: tutorialFile,\n                    handleBack: handleBack,\n                    handleSubmit: postTutorial\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 320,\n                    columnNumber: 23\n                  }, this);\n              }\n            })()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this), progress > 0 && /*#__PURE__*/_jsxDEV(LinearProgress, {\n        variant: \"determinate\",\n        value: progress\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 26\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 263,\n    columnNumber: 5\n  }, this);\n}\n\n_s(TutorialCreation, \"1cvaIOYPiuo8T785kgcatYZit4c=\", false, function () {\n  return [useStyles];\n});\n\n_c = TutorialCreation;\nexport default TutorialCreation;\n\nvar _c;\n\n$RefreshReg$(_c, \"TutorialCreation\");","map":{"version":3,"sources":["/Users/carinawollendorfer/selfix/frontend/src/views/TutorialCreation.js"],"names":["React","TutorialService","BikeComponentService","ToolCategoryService","TutorialCreationStepOne","TutorialCreationStepTwo","TutorialCreationStepThree","Grid","Card","CardContent","Typography","Stepper","Step","StepLabel","FileuploadService","Alert","LinearProgress","makeStyles","useStyles","main","marginLeft","marginRight","height","TutorialCreation","props","classes","stepLabels","editMode","setEditMode","useState","tutorialFetched","setTutorialFetched","componentsFetched","setComponentsFetched","toolsFetched","setToolsFetched","errorText","setErrorText","activeStep","setActiveStep","steps","setSteps","bikeComponents","setBikeComponents","toolCategories","setToolCategories","tutorialFile","setTutorialFile","progress","setProgress","tutorial","setTutorial","name","description","imageUrl","difficulty","timeRequired","useEffect","match","params","getTutorialWithBikeComponents","tutorialSteps","map","obj","step","title","mediaUrl","isPicStep","type","e","console","log","handleSelection","_id","data","getAvailableBikeComponents","selected","getUnmappedBikeComponents","getToolCategories","addStep","updatedSteps","push","updateStep","id","deleteStep","splice","handleSliderChange","propertyName","newValue","handleTutorialChange","event","target","value","state","setFunc","selectedIds","boolVal","selectedItems","filter","includes","rest","handleBCSelection","rows","handleDeselectBC","handleTCSelection","handleDeselectTC","asyncForEach","array","callback","index","length","postTutorial","requestBody","fileuploadResponse","uploadCMS","files","message","bikeComponentIds","textSteps","videoSteps","file","updateTutorial","createTutorial","history","error","handleNext","prevActiveStep","handleBack","undefined","label"],"mappings":"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","sourcesContent":["import React from 'react';\nimport TutorialService from '../services/TutorialService';\nimport BikeComponentService from '../services/BikeComponentService';\nimport ToolCategoryService from '../services/ToolCategoryService';\nimport TutorialCreationStepOne from '../components/cms/TutorialCreationStepOne';\nimport TutorialCreationStepTwo from '../components/cms/TutorialCreationStepTwo';\nimport TutorialCreationStepThree from '../components/cms/TutorialCreationStepThree';\nimport { Grid, Card, CardContent, Typography, Stepper, Step, StepLabel } from '@material-ui/core';\nimport FileuploadService from '../services/FileuploadService';\nimport { Alert } from '@material-ui/lab';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles(() => ({\n  main: {\n    marginLeft: '280px',\n    marginRight: '50px',\n    height: '100%',\n  },\n}));\n\nfunction TutorialCreation(props) {\n  const classes = useStyles();\n  const stepLabels = ['Basic Tutorial Information', 'Tutorial Steps', 'Related Products'];\n\n  const [editMode, setEditMode] = React.useState();\n  const [tutorialFetched, setTutorialFetched] = React.useState(false);\n  const [componentsFetched, setComponentsFetched] = React.useState(false);\n  const [toolsFetched, setToolsFetched] = React.useState(false);\n  const [errorText, setErrorText] = React.useState();\n  const [activeStep, setActiveStep] = React.useState(0);\n  const [steps, setSteps] = React.useState([]);\n  const [bikeComponents, setBikeComponents] = React.useState([]);\n  const [toolCategories, setToolCategories] = React.useState([]);\n  const [tutorialFile, setTutorialFile] = React.useState();\n  const [progress, setProgress] = React.useState(0);\n  const [tutorial, setTutorial] = React.useState({\n    name: '',\n    description: '',\n    imageUrl: '',\n    difficulty: 'Medium',\n    timeRequired: 60,\n  });\n\n  React.useEffect(async () => {\n    if (props.match.params.tutorial) {\n      setEditMode(true);\n\n      try {\n        const tutorial = await TutorialService.getTutorialWithBikeComponents(props.match.params.tutorial);\n        setTutorial(tutorial);\n\n        const tutorialSteps = tutorial.steps.map((obj) => {\n          const step = {};\n          step.title = obj.title;\n          step.description = obj.description;\n          step.mediaUrl = obj.mediaUrl;\n          step.isPicStep = obj.type === 'text' ? true : false;\n          return step;\n        });\n        setSteps(tutorialSteps);\n\n        setTutorialFetched(true);\n      } catch (e) {\n        console.log(e);\n      }\n    } else {\n      setEditMode(false);\n    }\n  }, [props.match.params.tutorial]);\n\n  React.useEffect(() => {\n    if (tutorialFetched && componentsFetched && toolsFetched) {\n      handleSelection(bikeComponents, setBikeComponents, tutorial.bikeComponents.map((obj) => obj._id), true);\n      handleSelection(toolCategories, setToolCategories, tutorial.toolCategories.map((obj) => obj._id), true);\n    }\n  }, [tutorialFetched, componentsFetched, toolsFetched]);\n\n  React.useEffect(async () => {\n    try {\n      if (props.match.params.tutorial) {\n        const data = await BikeComponentService.getAvailableBikeComponents(props.match.params.tutorial);\n        setBikeComponents(data.map((obj) => ({ ...obj, selected: false })));\n        setComponentsFetched(true);\n      } else {\n        const data = await BikeComponentService.getUnmappedBikeComponents();\n        setBikeComponents(data.map((obj) => ({ ...obj, selected: false })));\n      }\n    } catch(e) {\n      setErrorText(e);\n    }\n  }, [props.match.params.tutorial]);\n\n  React.useEffect(async () => {\n    try{\n      let data = await ToolCategoryService.getToolCategories();\n      setToolCategories(data.map((obj) => ({ ...obj, selected: false })));\n      setToolsFetched(true);\n    } catch(e) {\n      setErrorText(e);\n    }\n  }, [props.match.params.tutorial]);\n\n  const addStep = (step) => {\n    let updatedSteps = [...steps];\n    updatedSteps.push(step);\n    setSteps(updatedSteps);\n  };\n\n  const updateStep = (step, id) => {\n    let updatedSteps = [...steps];\n    updatedSteps[id] = step;\n    setSteps(updatedSteps);\n  };\n\n  const deleteStep = (id) => {\n    let updatedSteps = [...steps];\n    updatedSteps.splice(id, 1);\n    setSteps(updatedSteps);\n  };\n\n  const handleSliderChange = (propertyName, newValue) => {\n    setTutorial({\n      ...tutorial,\n      [propertyName]: newValue,\n    });\n  };\n\n  const handleTutorialChange = (event) => {\n    setTutorial({\n      ...tutorial,\n      [event.target.name]: event.target.value,\n    });\n  };\n\n  /**\n   * Sets the selected property to boolVal for the object of the\n   * state object with id in selectedIds.\n   * @param {*} state\n   * @param {*} setFunc\n   * @param {*} selectedIds\n   * @param {*} boolVal\n   */\n  const handleSelection = (state, setFunc, selectedIds, boolVal) => {\n    const selectedItems = state\n      .filter((obj) => selectedIds.includes(obj._id))\n      .map((obj) => ({ ...obj, selected: boolVal }));\n\n    let rest = state.filter((obj) => !selectedIds.includes(obj._id));\n    if (boolVal === true) {\n      rest = state.filter((obj) => !selectedIds.includes(obj._id)).map((obj) => ({ ...obj, selected: !boolVal }));\n    }\n    setFunc([...rest, ...selectedItems]);\n  };\n\n  const handleBCSelection = (rows) => {\n    handleSelection(bikeComponents, setBikeComponents, rows.map((obj) => obj._id), true);\n  };\n  const handleDeselectBC = (id) => {\n    handleSelection(bikeComponents, setBikeComponents, [id], false);\n  };\n\n  const handleTCSelection = (rows) => {\n    handleSelection(toolCategories, setToolCategories, rows.map((obj) => obj._id), true);\n  };\n  const handleDeselectTC = (id) => {\n    handleSelection(toolCategories, setToolCategories, [id], false);\n  };\n\n  async function asyncForEach(array, callback) {\n    for (let index = 0; index < array.length; index++) {\n      await callback(array[index], index, array);\n    }\n  }\n\n  const postTutorial = async () => {\n    try {\n      setProgress(0);\n      let requestBody = {};\n      requestBody.tutorial = tutorial;\n      let fileuploadResponse = {};\n      if (tutorialFile) {\n        try {\n          fileuploadResponse = await FileuploadService.uploadCMS(tutorialFile, 'tutorial');\n          if (fileuploadResponse.files && fileuploadResponse.files.length > 0) {\n            requestBody.tutorial.imageUrl = fileuploadResponse.files[0];\n          } else {\n            setErrorText('Tutorial:' + fileuploadResponse.message);\n            setProgress(0);\n            return;\n          }\n        } catch (e) {\n          setErrorText('Tutorial: Error while file upload. Please go back to step 1.');\n          setProgress(0);\n          return;\n        }\n      }\n      setProgress(5);\n      requestBody.tutorial.toolCategories = [];\n      requestBody.tutorial.toolCategories = toolCategories.filter((obj) => obj.selected).map((obj) => obj._id);\n\n      requestBody.bikeComponentIds = bikeComponents.filter((obj) => obj.selected).map((obj) => obj._id);\n\n      requestBody.textSteps = []; // List of text step objects\n      requestBody.videoSteps = []; // List of video step objects\n\n      await asyncForEach(steps, async (step) => {\n        if (step.file) {\n          try {\n            fileuploadResponse = await FileuploadService.uploadCMS(step.file, 'tutorialstep');\n            if (fileuploadResponse.files && fileuploadResponse.files.length > 0) {\n              step.mediaUrl = fileuploadResponse.files[0];\n            } else {\n              setErrorText('Step ' + step.title + ':' + fileuploadResponse.message);\n              setProgress(0);\n              return;\n            }\n          } catch (e) {\n            setErrorText('Step ' + step.title + ': Error while uploading file. Please go back to step 2.');\n            setProgress(0);\n            return;\n          }\n        }\n        setProgress(progress + 100 / (steps.length + 1));\n        delete step.file;\n      });\n\n      steps.map((step, index) => {\n        step['position'] = index;\n        const isPicStep = step.isPicStep;\n        delete step.isPicStep;\n\n        if (isPicStep) {\n          requestBody.textSteps.push(step);\n        } else {\n          requestBody.videoSteps.push(step);\n        }\n      });\n\n      if (editMode) {\n        await TutorialService.updateTutorial(requestBody);\n      } else {\n        await TutorialService.createTutorial(requestBody);\n      }\n\n      setProgress(100);\n      props.history.push('/admin/tutorials');\n    } catch (error) {\n      console.error(error);\n      setProgress(0);\n    }\n  };\n\n  const handleNext = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep + 1);\n  };\n\n  const handleBack = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\n  };\n\n  return (\n    <div className={classes.main}>\n      <Card>\n        <CardContent>\n          <Grid container spacing={5} justify=\"center\" alignItems=\"center\">\n            <Grid item xs={10}>\n              <Typography variant=\"h4\" noWrap>\n                Create New Tutorial\n              </Typography>\n              {errorText && (\n                <Alert severity=\"error\" onClose={() => setErrorText(undefined)}>\n                  {errorText}\n                </Alert>\n              )}\n            </Grid>\n            <Grid item xs={12}>\n              <Stepper activeStep={activeStep} alternativeLabel>\n                {stepLabels.map((label, index) => {\n                  return (\n                    <Step key={index}>\n                      <StepLabel>{label}</StepLabel>\n                    </Step>\n                  );\n                })}\n              </Stepper>\n            </Grid>\n\n            <Grid item xs={10}>\n              {(() => {\n                switch (activeStep) {\n                  case 0:\n                    return (\n                      <TutorialCreationStepOne\n                        setErrorText={setErrorText}\n                        setTutorialFile={setTutorialFile}\n                        tutorialFile={tutorialFile}\n                        handleTutorialChange={handleTutorialChange}\n                        handleSliderChange={handleSliderChange}\n                        tutorial={tutorial}\n                        handleSubmit={handleNext}\n                      />\n                    );\n                  case 1:\n                    return (\n                      <TutorialCreationStepTwo\n                        editMode={editMode}\n                        setErrorText={setErrorText}\n                        addStep={addStep}\n                        updateStep={updateStep}\n                        deleteStep={deleteStep}\n                        setSteps={setSteps}\n                        steps={steps}\n                        handleBack={handleBack}\n                        handleSubmit={handleNext}\n                      />\n                    );\n                  case 2:\n                    return (\n                      <TutorialCreationStepThree\n                        handleTCSelection={handleTCSelection}\n                        handleDeselectBC={handleDeselectBC}\n                        bikeComponents={bikeComponents}\n                        handleBCSelection={handleBCSelection}\n                        handleDeselectTC={handleDeselectTC}\n                        toolCategories={toolCategories}\n                        tutorialFile={tutorialFile}\n                        handleBack={handleBack}\n                        handleSubmit={postTutorial}\n                      />\n                    );\n                }\n              })()}\n            </Grid>\n          </Grid>\n        </CardContent>\n        {progress > 0 && <LinearProgress variant=\"determinate\" value={progress} />}\n      </Card>\n    </div>\n  );\n}\n\nexport default TutorialCreation;\n"]},"metadata":{},"sourceType":"module"}